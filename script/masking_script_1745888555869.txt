
CREATE CONV SAMAD.CONVERT
  SRCXF //'D:\Docs\Optim_Doc\Abdus Samad\Extract\Extract.csv'//
  DESTXF //'D:\Docs\Optim_Doc\Abdus Samad\Extract\Extract1.csv'//
  CF //'archive.CF'//
  FORCEEDITTM Y DELCNTLFILE N
  LOCALTM (
    SRCQUAL ${sourceQualifier} 
    DESTQUAL ${destinationQualifier} 
    VALRULES M UNUSEDOBJ Y SOLUTION 0
    (
      department = department LOCALCM (
        VALRULES M
        DSTUSESSRC T
        (
            department_id = department_id,
            "substr(department_name, 1, 4)" = department_name,
            "substr(head_of_department, 1, 10)" = head_of_department
        )
      )
      enrollment = enrollment LOCALCM (
        VALRULES M
        DSTUSESSRC T
        (
            enrollment_id = enrollment_id,
            "substr(student_id, 1, 3)" = student_id,
            course_id = course_id,
            "substr(enrollment_date, 1, 7)" = enrollment_date
        )
      )

        access_definition_change_log = access_definition_change_log,
        course = course,
        extract_config = extract_config,
        instructor = instructor,
        student = student,
        user_data = user_data
    )
    PROCEDURES (
      SYSTEM.GET_TOP_10_AU_LASTNAME = SYSTEM.GET_TOP_10_AU_LASTNAME,
      OPTIMDIR130.GET_TOP_10_SALES = OPTIMDIR130.GET_TOP_10_SALES,
      GET_TOP_10_AU_LASTNAME = GET_TOP_10_AU_LASTNAME,
      GET_10_SALES = GET_10_SALES
    )
  )
  SHOWCURRENCY Y SHOWAGE Y
  FUNCTION_AGING (
    AGETYPE NONE MULTIPLE 1 CALENDAR SAMPLE_AU PIVOT 30 INVALIDDATES N SKIPPEDDATES N
  )
  GLOBAL_AGING (
    AGETYPE NONE MULTIPLE 1 CALENDAR SAMPLE_AU PIVOT 30 INVALIDDATES N SKIPPEDDATES N
  )
  REPORT_OPTION (
    RPTERROR F 
    RPTSUMMARY F 
    RPTINVALID F 
    RPTSKIPPED F 
    RPTMASKVERIFICATION F
  )
  CURRENCY_OPTION (
    DEFAULT SAMPLE
  )
  COMPRESSFILE Y INCL_FILEATTACH N
  CSVF (
    FILEMACRO N 
    ROWCNT(0) 
    FILESIZE(0) 
    NUMFILES(0)
      OBJ(access_definition_change_log) PATH(//'0'//) ROWCNT(0) FILESIZE(0) NUMFILES(0),
      OBJ(course) PATH(//'0'//) ROWCNT(0) FILESIZE(0) NUMFILES(0),
      OBJ(department) PATH(//'0'//) ROWCNT(0) FILESIZE(0) NUMFILES(0),
      OBJ(enrollment) PATH(//'0'//) ROWCNT(0) FILESIZE(0) NUMFILES(0),
      OBJ(extract_config) PATH(//'0'//) ROWCNT(0) FILESIZE(0) NUMFILES(0),
      OBJ(instructor) PATH(//'0'//) ROWCNT(0) FILESIZE(0) NUMFILES(0),
      OBJ(student) PATH(//'0'//) ROWCNT(0) FILESIZE(0) NUMFILES(0),
      OBJ(user_data) PATH(//'0'//) ROWCNT(0) FILESIZE(0) NUMFILES(0)
    OPTIONS( GENMDATA N FIELDDELIM(//','//) STRDELIM(//'0'//) ESCCHAR(//'0'//) LOBENABLED N NULLCHECK N )
  )
;
