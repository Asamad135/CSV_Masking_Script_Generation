CREATE TM SAMAD.CONVERT
  SRCQUAL OPTIMSRC130.OPTIMSRC130 DESTQUAL OPTIMSRC130.OPTIMSRC130 
  SRCEXT //'D:\Docs\Optim_Doc\Abdus Samad\Extract\Extract.csv'// 
  SRCTYPE X DESTDB DEST 
  DESTTYPE D VALRULES M 
  UNUSEDOBJ Y SOLUTION 0 
  (   OPTIM_SALES = OPTIM_SALES LOCALCM (
    VALRULES M
    DSTUSESSRC T
    (     shuffle = SALESMAN_ID, 
     'substr(FIRST_NAME, 1, 7)' = FIRST_NAME, 
     LAST_NAME = LAST_NAME, 
     NATIONALITY = NATIONALITY, 
     NATIONAL_ID = NATIONAL_ID, 
     PHONE_NUMBER = PHONE_NUMBER, 
     AGE = AGE, 
     SEX = SEX, 
     TERRITORY = TERRITORY, 
     EMAIL_ADDRESS = EMAIL_ADDRESS, 
     MANAGER_ID = MANAGER_ID
)
    ),

   OPTIM_CUSTOMERS = OPTIM_CUSTOMERS LOCALCM (
    VALRULES M
    DSTUSESSRC T
    (     CUST_ID = CUST_ID, 
     CUSTNAME = CUSTNAME, 
     'RAND(10, 4999)' = ADDRESS1, 
     ADDRESS2 = ADDRESS2, 
     LOCALITY = LOCALITY, 
     CITY = CITY, 
     STATE = STATE, 
     COUNTRY_CODE = COUNTRY_CODE, 
     POSTAL_CODE = POSTAL_CODE, 
     POSTAL_CODE_PLUS4 = POSTAL_CODE_PLUS4, 
     EMAIL_ADDRESS = EMAIL_ADDRESS, 
     PHONE_NUMBER = PHONE_NUMBER, 
     YTD_SALES = YTD_SALES, 
     SALESMAN_ID = SALESMAN_ID, 
     NATIONALITY = NATIONALITY, 
     "TRANS SSN('=- NATIONAL_ID')" = NATIONAL_ID, 
     CREDITCARD_NUMBER = CREDITCARD_NUMBER, 
     CREDITCARD_TYPE = CREDITCARD_TYPE, 
     CREDITCARD_EXP = CREDITCARD_EXP, 
     CREDITCARD_CVV = CREDITCARD_CVV, 
     DRIVER_LICENSE = DRIVER_LICENSE, 
     CREDITCARD_HISTORY = CREDITCARD_HISTORY
)
    ),

   OPTIM_ORDERS = OPTIM_ORDERS,

   OPTIM_DETAILS = OPTIM_DETAILS,

   OPTIM_ITEMS = OPTIM_ITEMS
)
  PROCEDURES (   SYSTEM.GET_TOP_10_AU_LASTNAME,
   OPTIMDIR130.GET_TOP_10_SALES,
   GET_TOP_10_AU_LASTNAME,
   GET_10_SALES
)
;